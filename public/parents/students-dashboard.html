<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parent / Student Portal | Karumande Link School</title>

  <!-- Google Font (Inter) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  
  <link rel="stylesheet" href="/style.css" />
</head>
<body>

  <header>
    <div class="header-container">
      <div class="header-title">
        <i class="fa-solid fa-user-graduate"></i> Parent / Student Portal
      </div>
      <button class="logout-btn" onclick="logout()">
        <i class="fa-solid fa-arrow-right-from-bracket"></i> Logout
      </button>
    </div>
  </header>

  <div class="container">

    <!-- Student Summary Cards -->
    <div class="cards">
      <div class="card">
        <h3>Student Name</h3>
        <p id="studentName">Loading...</p>
      </div>
      <div class="card">
        <h3>Class / Grade</h3>
        <p id="studentClass">Loading...</p>
      </div>
      <div class="card">
        <h3>Admission Number</h3>
        <p id="studentAdmission">Loading...</p>
      </div>
      <div class="card">
        <h3>Fee Balance</h3>
        <p id="feeBalance">Loading...</p>
      </div>
      <div class="card">
        <h3>Payment Status</h3>
        <p><span class="badge partial" id="feeStatus">Loading</span></p>
      </div>
    </div>

    <!-- Fees Summary -->
    <h2><i class="fa-solid fa-money-bill-wave"></i> Fees Summary</h2>
    <div class="table-container">
      <table id="feesTable">
        <thead>
          <tr>
            <th>Term</th>
            <th>Total Fee</th>
            <th>Amount Paid</th>
            <th>Balance</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="feesTableBody">
          <tr>
            <td colspan="5" style="text-align: center;">Loading...</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- M-Pesa Payment Section -->
    <div class="card" id="paymentSection" style="display: none;">
      <h3><i class="fa-solid fa-mobile-screen-button"></i> Pay School Fees via M-Pesa</h3>
      <div class="payment-form">
        <div class="form-row">
          <div>
            <label for="paymentPhone">M-Pesa Phone Number</label>
            <input type="tel" id="paymentPhone" placeholder="254712345678" required />
          </div>
          <div>
            <label for="paymentAmount">Amount (KES)</label>
            <input type="number" id="paymentAmount" placeholder="5000" min="1" required />
          </div>
        </div>
        <div class="form-actions">
          <button id="payBtn" class="btn primary">
            <i class="fa-solid fa-paper-plane"></i> Send STK Push
          </button>
        </div>
      </div>
      <div class="payment-info">
        <h4>Payment Instructions:</h4>
        <ul>
          <li><strong>1. EQUITY Paybill:</strong> 676554<br>
              Account: <em id="equityAccount">Loading...</em></li>
          <li><strong>2. KCB Paybill:</strong> 522522<br>
              Account: <em id="kcbAccount">Loading...</em></li>
          <li><strong>3. FORTUNE Paybill:</strong> 852648<br>
              Account: <em id="fortuneAccount">Loading...</em></li>
        </ul>
        <p><strong>Note:</strong> You can also pay manually using the paybill numbers above with your child's name and class as account reference.</p>
      </div>
    </div>

    <!-- Latest Results -->
    <h2><i class="fa-solid fa-chart-line"></i> Latest Exam Results</h2>
    <div class="table-container">
      <table id="resultsTable">
        <thead>
          <tr>
            <th>Term</th>
            <th>Subject</th>
            <th>Marks (/100)</th>
            <th>Grade</th>
            <th>Remarks</th>
          </tr>
        </thead>
        <tbody id="resultsTableBody">
          <tr>
            <td colspan="5" style="text-align: center;">Loading...</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- School Announcements -->
    <h2><i class="fa-solid fa-bullhorn"></i> School Announcements</h2>
    <div id="dashboardAnnouncementsContainer" class="announcements">
      <div style="text-align: center; padding: 40px; color: var(--muted);">
        <i class="fa-solid fa-hourglass-end"></i> Loading announcements...
      </div>
    </div>

  </div>

  <script src="/parents/students-dashboard.js"></script>
</body>
</html>